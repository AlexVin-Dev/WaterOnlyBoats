plugins {
    id 'java'
    id("xyz.jpenilla.run-paper") version "2.3.1"
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Java
java {
    toolchain.languageVersion = JavaLanguageVersion.of(21)
}

// –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
group = 'ru.aspirez'
version = '1.5.0'

repositories {
    mavenCentral()
    maven {
        name = "spigotmc-repo"
        url = "https://hub.spigotmc.org/nexus/content/repositories/snapshots/"
    }
}

dependencies {
    compileOnly("org.spigotmc:spigot-api:1.21.4-R0.1-SNAPSHOT")
}

// –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ Minecraft —á–µ—Ä–µ–∑ run-paper
tasks.runServer {
    minecraftVersion("1.21")
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–µ—Ä—Å–∏–∏ –≤ plugin.yml)
processResources {
    filteringCharset 'UTF-8'
    filesMatching('plugin.yml') {
        expand version: version
    }
}

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ JAR –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏
tasks.jar.finalizedBy('logJarSize')

task logJarSize() {
    doLast {
        def jarFile = tasks.jar.archiveFile.get().asFile
        def sizeKb = (jarFile.length() / 1024).round(2)
        logger.quiet "üì¶ JAR —Å–æ–±—Ä–∞–Ω: ${jarFile.name} | –†–∞–∑–º–µ—Ä: ~${sizeKb} –ö–ë"
    }
}